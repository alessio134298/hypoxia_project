# #creiamo un bed file background concatenando tutti i bed IDR di Cas9, senza fare merge in modo da lasciare tutti i picchi possibili indipendentemente

# #H3K27ac
# cat /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H3K27AC/idr_results/Cas9_normoxia_IDR_consensus.bed /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H3K27AC/idr_results/Cas9_H6_IDR_consensus.bed /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H3K27AC/idr_results/Cas9_H24_IDR_consensus.bed > H3K27ac_Cas9_background.bed

# #H2BK120ac
# cat /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H2BK120AC/idr_results/Cas9_normoxia_IDR_consensus.bed /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H2BK120AC/idr_results/Cas9_H6_IDR_consensus.bed /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H2BK120AC/idr_results/Cas9_H24_IDR_consensus.bed > H2BK120ac_Cas9_background.bed



# #Usiamo EnrichARd per vedere l'overlap

# #H3K27ac
# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H3K27AC/idr_results/Cas9_normoxia_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H3K27ac_Cas9_background.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H3K27ac_H0_on_EPAS1.txt

# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H3K27AC/idr_results/Cas9_H6_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H3K27ac_Cas9_background.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H3K27ac_H6_on_EPAS1.txt

# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H3K27AC/idr_results/Cas9_H24_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H3K27ac_Cas9_background.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H3K27ac_H24_on_EPAS1.txt

# #H2BK120ac
# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H2BK120AC/idr_results/Cas9_normoxia_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H2BK120ac_Cas9_background.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H2BK120ac_H0_on_EPAS1.txt

# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H2BK120AC/idr_results/Cas9_H6_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H2BK120ac_Cas9_background.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H2BK120ac_H6_on_EPAS1.txt

# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H2BK120AC/idr_results/Cas9_H24_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H2BK120ac_Cas9_background.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H2BK120ac_H24_on_EPAS1.txt



# # Provo a usare un background ridotto
# #H3K27ac
# sort -k1,1 -k2,2n H3K27ac_Cas9_background.bed | bedtools merge -i - > H3K27ac_Cas9_background_reduced.bed

# #H2BK120ac
# sort -k1,1 -k2,2n H2BK120ac_Cas9_background.bed | bedtools merge -i - > H2BK120ac_Cas9_background_reduced.bed

# #H3K27ac
# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H3K27AC/idr_results/Cas9_normoxia_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H3K27ac_Cas9_background_reduced.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H3K27ac_H0_on_EPAS1.txt

# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H3K27AC/idr_results/Cas9_H6_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H3K27ac_Cas9_background_reduced.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H3K27ac_H6_on_EPAS1.txt

# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H3K27AC/idr_results/Cas9_H24_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H3K27ac_Cas9_background_reduced.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H3K27ac_H24_on_EPAS1.txt

# #H2BK120ac
# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H2BK120AC/idr_results/Cas9_normoxia_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H2BK120ac_Cas9_background_reduced.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H2BK120ac_H0_on_EPAS1.txt

# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H2BK120AC/idr_results/Cas9_H6_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H2BK120ac_Cas9_background_reduced.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H2BK120ac_H6_on_EPAS1.txt

# python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input /media/alessio/Data/hypoxia/ChIPseq/IDR/IDR_H2BK120AC/idr_results/Cas9_H24_IDR_consensus.bed  --target ../HIF2a_all_putative_binding_sites_noRandom.bed   --background H2BK120ac_Cas9_background_reduced.bed --orientation strandless --randomization 200 --outfile EPAS1_data/Cas9_H2BK120ac_H24_on_EPAS1.txt




#Non va bene, uso i risultati di DiffBind
#H3K27ac Cas9
python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input ../../ChIPseq/DiffBind_bed_files/entires/H3K27ac_Up_Vs_normoxia_CAS9_6h_DiffBind_enriched_peaks.bed --target EPAS1_data/EPAS1_final_reduced_no_blacklist.bed,EPAS1_data/EPAS1_on_EPAS1_motif.bed,EPAS1_data/EPAS1_on_ARNT_motif.bed,EPAS1_data/EPAS1_on_EPAS1_ARNT_summed.bed,../HIF2a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF2a.4.cell.lines.bed,../HIF1a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF1a.4.cell.lines.bed,EPAS1_data/cluster_Peakset/Peaks_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_2_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_2_EPAS1_peaks.bed  --background ../../ChIPseq/DiffBind_matrix_scaffolds_H3K27ac/DiffBind_matrix_anno.bed --orientation strandless --randomization 1000 --outfile EPAS1_data/Cas9_H3K27ac_H6_vs_H0_Diffbind_on_EPAS1.txt

python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input ../../ChIPseq/DiffBind_bed_files/entires/H3K27ac_Up_Vs_normoxia_CAS9_24h_DiffBind_enriched_peaks.bed --target EPAS1_data/EPAS1_final_reduced_no_blacklist.bed,EPAS1_data/EPAS1_on_EPAS1_motif.bed,EPAS1_data/EPAS1_on_ARNT_motif.bed,EPAS1_data/EPAS1_on_EPAS1_ARNT_summed.bed,../HIF2a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF2a.4.cell.lines.bed,../HIF1a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF1a.4.cell.lines.bed,EPAS1_data/cluster_Peakset/Peaks_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_2_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_2_EPAS1_peaks.bed    --background ../../ChIPseq/DiffBind_matrix_scaffolds_H3K27ac/DiffBind_matrix_anno.bed --orientation strandless --randomization 1000 --outfile EPAS1_data/Cas9_H3K27ac_H24_vs_H0_Diffbind_on_EPAS1.txt

#H2BK120ac Cas9
python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input ../../ChIPseq/DiffBind_bed_files/entires/H2BK120ac_Up_Vs_normoxia_CAS9_6h_DiffBind_enriched_peaks.bed --target EPAS1_data/EPAS1_final_reduced_no_blacklist.bed,EPAS1_data/EPAS1_on_EPAS1_motif.bed,EPAS1_data/EPAS1_on_ARNT_motif.bed,EPAS1_data/EPAS1_on_EPAS1_ARNT_summed.bed,../HIF2a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF2a.4.cell.lines.bed,../HIF1a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF1a.4.cell.lines.bed,EPAS1_data/cluster_Peakset/Peaks_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_2_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_2_EPAS1_peaks.bed   --background ../../ChIPseq/DiffBind_matrix_scaffolds_H2BK120ac/DiffBind_matrix_anno.bed --orientation strandless --randomization 1000 --outfile EPAS1_data/Cas9_H2BK120ac_H6_vs_H0_Diffbind_on_EPAS1.txt

python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input ../../ChIPseq/DiffBind_bed_files/entires/H2BK120ac_Up_Vs_normoxia_CAS9_24h_DiffBind_enriched_peaks.bed --target EPAS1_data/EPAS1_final_reduced_no_blacklist.bed,EPAS1_data/EPAS1_on_EPAS1_motif.bed,EPAS1_data/EPAS1_on_ARNT_motif.bed,EPAS1_data/EPAS1_on_EPAS1_ARNT_summed.bed,../HIF2a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF2a.4.cell.lines.bed,../HIF1a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF1a.4.cell.lines.bed,EPAS1_data/cluster_Peakset/Peaks_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_2_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_2_EPAS1_peaks.bed   --background ../../ChIPseq/DiffBind_matrix_scaffolds_H2BK120ac/DiffBind_matrix_anno.bed --orientation strandless --randomization 1000 --outfile EPAS1_data/Cas9_H2BK120ac_H24_vs_H0_Diffbind_on_EPAS1.txt


#H3K27ac H4KO
python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input ../../ChIPseq/DiffBind_bed_files/entires/H3K27ac_Up_Vs_normoxia_H4KO_6h_DiffBind_enriched_peaks.bed --target EPAS1_data/EPAS1_final_reduced_no_blacklist.bed,EPAS1_data/EPAS1_on_EPAS1_motif.bed,EPAS1_data/EPAS1_on_ARNT_motif.bed,EPAS1_data/EPAS1_on_EPAS1_ARNT_summed.bed,../HIF2a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF2a.4.cell.lines.bed,../HIF1a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF1a.4.cell.lines.bed,EPAS1_data/cluster_Peakset/Peaks_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_2_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_2_EPAS1_peaks.bed   --background ../../ChIPseq/DiffBind_matrix_scaffolds_H3K27ac/DiffBind_matrix_anno.bed --orientation strandless --randomization 1000 --outfile EPAS1_data/H4KO_H3K27ac_H6_vs_H0_Diffbind_on_EPAS1.txt

python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input ../../ChIPseq/DiffBind_bed_files/entires/H3K27ac_Up_Vs_normoxia_H4KO_24h_DiffBind_enriched_peaks.bed --target EPAS1_data/EPAS1_final_reduced_no_blacklist.bed,EPAS1_data/EPAS1_on_EPAS1_motif.bed,EPAS1_data/EPAS1_on_ARNT_motif.bed,EPAS1_data/EPAS1_on_EPAS1_ARNT_summed.bed,../HIF2a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF2a.4.cell.lines.bed,../HIF1a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF1a.4.cell.lines.bed,EPAS1_data/cluster_Peakset/Peaks_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_2_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_2_EPAS1_peaks.bed    --background ../../ChIPseq/DiffBind_matrix_scaffolds_H3K27ac/DiffBind_matrix_anno.bed --orientation strandless --randomization 1000 --outfile EPAS1_data/H4KO_H3K27ac_H24_vs_H0_Diffbind_on_EPAS1.txt

#H2BK120ac Cas9
python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input ../../ChIPseq/DiffBind_bed_files/entires/H2BK120ac_Up_Vs_normoxia_H4KO_6h_DiffBind_enriched_peaks.bed --target EPAS1_data/EPAS1_final_reduced_no_blacklist.bed,EPAS1_data/EPAS1_on_EPAS1_motif.bed,EPAS1_data/EPAS1_on_ARNT_motif.bed,EPAS1_data/EPAS1_on_EPAS1_ARNT_summed.bed,../HIF2a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF2a.4.cell.lines.bed,../HIF1a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF1a.4.cell.lines.bed,EPAS1_data/cluster_Peakset/Peaks_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_2_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_2_EPAS1_peaks.bed    --background ../../ChIPseq/DiffBind_matrix_scaffolds_H2BK120ac/DiffBind_matrix_anno.bed --orientation strandless --randomization 1000 --outfile EPAS1_data/H4KO_H2BK120ac_H6_vs_H0_Diffbind_on_EPAS1.txt

python3 ../../../EnrichaRd/EnrichaRd/EnrichaRd_v0_1.py --mode intersect --input ../../ChIPseq/DiffBind_bed_files/entires/H2BK120ac_Up_Vs_normoxia_H4KO_24h_DiffBind_enriched_peaks.bed --target EPAS1_data/EPAS1_final_reduced_no_blacklist.bed,EPAS1_data/EPAS1_on_EPAS1_motif.bed,EPAS1_data/EPAS1_on_ARNT_motif.bed,EPAS1_data/EPAS1_on_EPAS1_ARNT_summed.bed,../HIF2a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF2a.4.cell.lines.bed,../HIF1a_all_putative_binding_sites_noRandom.bed,../PRJNA823676/HIF1a.4.cell.lines.bed,EPAS1_data/cluster_Peakset/Peaks_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_2_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_1_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_4_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Peaks_3_EPAS1_peaks.bed,EPAS1_data/cluster_Peakset/Sample_2_EPAS1_peaks.bed   --background ../../ChIPseq/DiffBind_matrix_scaffolds_H2BK120ac/DiffBind_matrix_anno.bed --orientation strandless --randomization 1000 --outfile EPAS1_data/H4KO_H2BK120ac_H24_vs_H0_Diffbind_on_EPAS1.txt